# MBOX_2_PST
Mbox to pst converter

A .NET solution for converting MBOX files to PST format with both console and web UI interfaces.

## Features

- .NET console application that converts between MBOX and PST formats **bidirectionally**
- .NET Blazor web application for email viewing and conversion management
- Uses MimeKit for MBOX parsing and Aspose.Email for PST creation/reading
- Command-line interface for easy automation
- Web-based user interface for interactive email viewing and conversion
- Preserves email metadata, attachments, and formatting

## Console Application

### Features

- **Bidirectional conversion** between MBOX and PST formats
  - MBOX to PST conversion
  - PST to MBOX conversion (reverse conversion)
- Preserves email metadata (sender, recipients, subject, date)
- Handles email attachments
- Command-line interface for easy automation
- Error handling and validation

### Requirements

- .NET 8.0 or later

### Usage

The converter supports bidirectional conversion between MBOX and PST formats:

```bash
cd MboxToPstConverter
dotnet run <input> <output>
```

#### Conversion Types

**MBOX to PST:**
```bash
dotnet run input.mbox output.pst
```

**PST to MBOX:**
```bash
dotnet run input.pst output.mbox
```

#### Parameters

- `input` - Path to the input file (MBOX or PST format)
- `output` - Path to the output file (PST or MBOX format)

The conversion direction is automatically determined by the file extensions.

#### Examples

Convert MBOX to PST:
```bash
dotnet run emails.mbox converted_emails.pst
```

Convert PST to MBOX:
```bash
dotnet run emails.pst converted_emails.mbox
```

### Expected Output and Error Messages

During conversion, you may see various messages indicating the progress and status:

#### Normal Output
```
Starting conversion from emails.mbox to converted_emails.pst
Input: /path/to/emails.mbox
Output: /path/to/converted_emails.pst

Parsing MBOX file: /path/to/emails.mbox
File size: 25.34 MB
Parsed 50 messages...
Parsed 100 messages...
Finished parsing MBOX file. Total messages found: 150

Creating PST file...
PST file created. Processing messages...
Processed 10 messages (8 successful, 2 failed)
Processed 20 messages (18 successful, 2 failed)
...
Conversion completed: 145 messages successfully added to PST file, 5 messages failed.
Note: 5 messages failed due to invalid email addresses or other formatting issues. This is normal when processing MBOX files with malformed data.

Conversion completed successfully!
PST file created: /path/to/converted_emails.pst
```

#### Common Error Messages (Expected Behavior)

**Failed message errors**: Some messages may fail to convert due to:
- Invalid or malformed email addresses in the original MBOX file
- Corrupted message headers
- Unsupported email formatting

These failures are normal and expected when processing real-world MBOX files. The converter will:
- Skip problematic messages and continue processing
- Show detailed information about failed messages (subject, sender, error reason)
- Report the total count of successful and failed conversions

**Example failed message output**:
```
Failed to add message #25 - Subject: 'Weekly Newsletter', From: 'Invalid<>Address' - Error: The specified string is not in the form required for an e-mail address.
```

This indicates that message #25 has an invalid email address format in the original MBOX file and cannot be converted to PST format.

### Troubleshooting

#### High Number of Failed Messages

If you see a high percentage of failed messages:

1. **Check MBOX file quality**: Some MBOX files may have been corrupted or generated by tools that don't follow email standards strictly.

2. **Review error messages**: Look at the specific error messages to understand what's causing failures:
   - Email address format issues are the most common
   - Invalid date formats
   - Corrupted message headers

3. **Expected failure rate**: It's normal to see 5-10% of messages fail in typical MBOX files due to:
   - Spam emails with malformed headers
   - Old emails with non-standard formatting
   - Messages from outdated email systems

#### No Messages Processed

If no messages are being processed:
- Verify the MBOX file path is correct
- Check that the MBOX file is not empty
- Ensure you have read permissions on the input file
- Verify you have write permissions to the output directory

#### Performance Tips

- Large MBOX files (>1GB) may take significant time to process
- Progress is shown every 10-50 messages depending on the operation
- Consider splitting very large MBOX files if conversion takes too long

### Dependencies

- MimeKit - for parsing MBOX files
- Aspose.Email - for creating PST files

## Blazor Web Application

### Features

- Cross-platform web-based user interface
- Email viewing for both MBOX and PST formats
- Interactive file selection for input and output paths
- Real-time conversion progress display
- Email list browsing and content preview
- **Large file support**: Upload files up to 50GB with streaming technology
- **Progress tracking**: Real-time upload progress with chunked streaming
- **Download functionality**: Secure download links for converted files

### Requirements

- .NET 8.0 or later

### Usage

```bash
cd MboxToPstBlazorApp
dotnet run
```

Then open https://localhost:5001 (or the URL shown in the console) in your web browser.

### Large File Support

The Blazor web application supports uploading large email files (up to 50GB) using:

- **Streaming upload**: Files are uploaded in 1MB chunks to prevent memory issues
- **Progress tracking**: Real-time progress updates during upload
- **Server configuration**: Optimized server settings for large file handling
- **Download functionality**: Secure download links for converted files

This makes it suitable for processing very large MBOX or PST files that were previously limited to 10GB.

### Building

**Entire Solution:**
```bash
dotnet build
```

**Console Application:**
```bash
cd MboxToPstConverter
dotnet build
```

**Blazor Web Application:**
```bash
cd MboxToPstBlazorApp
dotnet build
```

## License

This project is provided as-is for educational and personal use.
